---
title: 多个按钮单击事件
date: 2020-09-05 01:34:01
categories:
    - JavaScript
tags:
    - 面试题
---
关于多个按钮单击弹出结果面试题考察分析如下：
<!--more-->
- 题目部分代码片段如下
```javascript
var btnBox = document.getElementById('btnBox')
var inputs = btnBox.getElementsByTagName('input')
var l = inputs.length
for(var i=0;i<l;i++){ // 点击时候循环已结束， i = 5
    inputs[i].click = function(){
        alert(i)
    }
}
```
- 以上题目涉及到如下知识
  - **所有的事件绑定都是异步编程**（绑定的时候方法并没有执行），当点击触发的时候，循环早已经结束
    - 同步：Js中当前任务没有完成，之后的任务不会执行
    - 异步：Js中当前任务没有完成，可以继续执行其他任务

- 三种解决方案如下：
    1. 自定义属性
```javascript
for(var i=0;i<l;i++){
    inputs[i].MyIndex = i
    inputs[i].click = function(){
        alert(this..MyIndex)
    }
}
```
    2. 闭包
```javascript
for(var i=0;i<l;i++){
    ~(function(i){
        inputs[i].click = function(){
            alert(this..MyIndex)
        }
    })(i)
}
// 另一种写法, 形成多个不销毁的闭包，性能不好
for(var i=0;i<l;i++){
    inputs[i].click = (function(i){
        return function(){
            alert(i)
        }
    })(i)
}
```
    3. ES6（块级作用域）
```javascript
for(let i=0;i<l;i++){
    inputs[i].click = function(){
        alert(i)
    }
}
```
